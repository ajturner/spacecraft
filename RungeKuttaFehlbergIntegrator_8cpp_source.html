<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Open-Sessame Framework: RungeKuttaFehlbergIntegrator.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Open-Sessame Framework
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('RungeKuttaFehlbergIntegrator_8cpp_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">RungeKuttaFehlbergIntegrator.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="RungeKuttaFehlbergIntegrator_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RungeKuttaFehlbergIntegrator_8h.html">RungeKuttaFehlbergIntegrator.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceO__SESSAME.html">O_SESSAME</a> {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#a55ed76bd88bb6c4532438237fc1eba16">   17</a></span>&#160;<a class="code" href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#a55ed76bd88bb6c4532438237fc1eba16">RungeKuttaFehlbergIntegrator::RungeKuttaFehlbergIntegrator</a>() : m_Tolerance(0.00001), m_minStepSize(0.01), m_maxStepSize(0.25)</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;}</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#a4f68217899f0d4a046c0d697a4aa9d9f">   21</a></span>&#160;<a class="code" href="classCAMdoubleMatrix.html">Matrix</a> <a class="code" href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#a4f68217899f0d4a046c0d697a4aa9d9f">RungeKuttaFehlbergIntegrator::Integrate</a>(<span class="keyword">const</span> vector&lt;ssfTime&gt;&amp; _propTime, <a class="code" href="group__IntegrationLibrary.html#ga1cbb02291f0827a9a385849d7a24fd73">odeFunctor</a> _odeFunctorPtr, <span class="keyword">const</span> <a class="code" href="classCAMdoubleVector.html">Vector</a>&amp; _initialConditions, <a class="code" href="classO__SESSAME_1_1Orbit.html">Orbit</a>* _pOrbit, <a class="code" href="classO__SESSAME_1_1Attitude.html">Attitude</a>* _pAttitude, <span class="keyword">const</span> <a class="code" href="classCAMdoubleMatrix.html">Matrix</a>&amp; _constants, <span class="keyword">const</span> <a class="code" href="classO__SESSAME_1_1Functor.html">Functor</a>&amp; _functorPtr)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        vector&lt;ssfTime&gt;::const_iterator timeIterator = _propTime.begin();</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <a class="code" href="classO__SESSAME_1_1ssfTime.html">ssfTime</a> timeInitial = (*timeIterator);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        timeIterator = _propTime.end() - 1;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <a class="code" href="classO__SESSAME_1_1ssfTime.html">ssfTime</a> timeFinal = (*timeIterator);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <a class="code" href="classO__SESSAME_1_1ssfTime.html">ssfTime</a> t = timeInitial;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordtype">double</span> h = <a class="code" href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#af288d8eab8dce90b3ecbedfab54d26c6">m_maxStepSize</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordtype">double</span> delta;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keywordtype">bool</span> hAccepted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordtype">int</span> numEqs = _initialConditions.<a class="code" href="classCAMvectorBase.html#a5a3aa53604c8cf36819e1cb38002787f">getIndexCount</a>();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <a class="code" href="classCAMdoubleVector.html">Vector</a> inputs = _initialConditions;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="classCAMdoubleVector.html">Vector</a> tempVector = inputs;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="classCAMdoubleVector.html">Vector</a> Error(numEqs);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="classCAMdoubleVector.html">Vector</a> K1(numEqs);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="classCAMdoubleVector.html">Vector</a> K2(numEqs);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <a class="code" href="classCAMdoubleVector.html">Vector</a> K3(numEqs);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="classCAMdoubleVector.html">Vector</a> K4(numEqs);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="classCAMdoubleVector.html">Vector</a> K5(numEqs);      </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="classCAMdoubleVector.html">Vector</a> K6(numEqs);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        vector&lt;Vector&gt; output; <span class="comment">// state + time</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        output.reserve(floor((timeFinal-timeInitial) / <a class="code" href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#af288d8eab8dce90b3ecbedfab54d26c6">m_maxStepSize</a>));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        output.push_back(<a class="code" href="namespaceO__SESSAME.html#aa5cbaab43220a5b5e4dcfecb6d6644f6">Vector</a>(numEqs+1));</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        output[0](<a class="code" href="namespaceO__SESSAME.html#aa03fb4f40ef9d7154a59fc366e35c768">MatrixIndexBase</a>) = timeInitial.<a class="code" href="classO__SESSAME_1_1ssfTime.html#a2e283e1e7262b7f5e00bd1cef2427829">GetSeconds</a>();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        output[0](<a class="code" href="access_8h.html#a897762bc9d770a93b04900046ac844b6">_</a>(<a class="code" href="namespaceO__SESSAME.html#aa03fb4f40ef9d7154a59fc366e35c768">MatrixIndexBase</a>+1,<a class="code" href="namespaceO__SESSAME.html#aa03fb4f40ef9d7154a59fc366e35c768">MatrixIndexBase</a>+numEqs)) = _initialConditions;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="classO__SESSAME_1_1ssfTime.html">ssfTime</a> tTemp;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="classCAMdoubleVector.html">Vector</a> temp(numEqs);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordtype">int</span> ii = 1;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">while</span> (t.<a class="code" href="classO__SESSAME_1_1ssfTime.html#a2e283e1e7262b7f5e00bd1cef2427829">GetSeconds</a>() &lt; timeFinal.<a class="code" href="classO__SESSAME_1_1ssfTime.html#a2e283e1e7262b7f5e00bd1cef2427829">GetSeconds</a>())</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            hAccepted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            K1 = h * _odeFunctorPtr(t, inputs, _pOrbit, _pAttitude, _constants, _functorPtr);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            tTemp = t + h / 4.;         temp = inputs + K1 / 4.0; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            K2 = h * _odeFunctorPtr(tTemp, temp, _pOrbit, _pAttitude, _constants, _functorPtr);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            tTemp = t + 3/8. * h;       temp = inputs + (3/32. * K1 + 9/32. * K2);                      </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            K3 = h * _odeFunctorPtr(tTemp, temp, _pOrbit, _pAttitude, _constants, _functorPtr);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            tTemp = t + 12/13. * h;     temp = inputs + (1932. * K1 - 7200. * K2 + 7296. * K3) / 2197.;                         </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            K4 = h * _odeFunctorPtr(tTemp, temp, _pOrbit, _pAttitude, _constants, _functorPtr);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            tTemp = t + h;              temp = inputs + (439/216. * K1 - 8. * K2 +3680/513. * K3 - 845/4104. * K4);                     </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            K5 = h * _odeFunctorPtr(tTemp, temp, _pOrbit, _pAttitude, _constants, _functorPtr);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            tTemp = t + h / 2;          temp = inputs - 8/27. * K1 +2. * K2 - 3544/2565. * K3 + 1859/4104. * K4 - 11/40.<span class="comment">/*0.275*/</span>* K5; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            K6 = h * _odeFunctorPtr(tTemp, temp, _pOrbit, _pAttitude, _constants, _functorPtr);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="comment">// Check that all the variables are within tolerance</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = <a class="code" href="namespaceO__SESSAME.html#aa03fb4f40ef9d7154a59fc366e35c768">MatrixIndexBase</a>; jj &lt; <a class="code" href="namespaceO__SESSAME.html#aa03fb4f40ef9d7154a59fc366e35c768">MatrixIndexBase</a> + numEqs; ++jj)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                <span class="comment">//  If error &lt;= tolerance, calculate integral &amp; output</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                Error(jj) = 1/h * <a class="code" href="camblas_2f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(K1(jj)/360. - 128/4275. * K3(jj) - 2197/75240. * K4(jj) + K5(jj)/50. + K6(jj)/27.5);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//      Could be used for testing</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//                wTilda = 16/135*K1(jj) + 6656/12825 * K3(jj) + 28561/56430 * K4(jj) - 9/50 * K5(jj) + 2/55*K6(jj);</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//                w = 25/216 * K1(jj) + 1408/2565 * K3(jj) + 2197/4104 * K4(jj) - 0.2* K5(jj);</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">//                Error(jj) = abs(wTilda - w);</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                <span class="keywordflow">if</span>((Error(jj) &lt;= <a class="code" href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#aa730511f060f890a529a58922f73e0f2">m_Tolerance</a>) || (h &lt; <a class="code" href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#a9beb30ac980ef4eb16ec750186388dc4">m_minStepSize</a>))</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                        tempVector(jj) = inputs(jj) + 25/216. * K1(jj) + 1408/2565. * K3(jj) + 2197/4104. * K4(jj) - 0.2* K5(jj);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                {<span class="comment">// if error &gt; tolerance, calc new step size, and re-integrate this step</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    hAccepted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                    delta = 0.84 * pow((<a class="code" href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#aa730511f060f890a529a58922f73e0f2">m_Tolerance</a> / Error(jj)), 0.25);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                    <span class="keywordflow">if</span>(delta &lt;= 0.1)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                        h = 0.1*h;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(delta &gt; 4)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                        h = 4*h;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                        h = delta * h;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    <span class="keywordflow">if</span> (h &gt; <a class="code" href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#af288d8eab8dce90b3ecbedfab54d26c6">m_maxStepSize</a>)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                        h = <a class="code" href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#af288d8eab8dce90b3ecbedfab54d26c6">m_maxStepSize</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="comment">// if all variables are within tolerance, then save output and step forward</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordflow">if</span>(hAccepted)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                t = t + h;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                inputs = tempVector;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                output.push_back(<a class="code" href="namespaceO__SESSAME.html#aa5cbaab43220a5b5e4dcfecb6d6644f6">Vector</a>(numEqs+1));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                output[ii](<a class="code" href="namespaceO__SESSAME.html#aa03fb4f40ef9d7154a59fc366e35c768">MatrixIndexBase</a>) = t.<a class="code" href="classO__SESSAME_1_1ssfTime.html#a2e283e1e7262b7f5e00bd1cef2427829">GetSeconds</a>();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                output[ii](<a class="code" href="access_8h.html#a897762bc9d770a93b04900046ac844b6">_</a>(<a class="code" href="namespaceO__SESSAME.html#aa03fb4f40ef9d7154a59fc366e35c768">MatrixIndexBase</a>+1,<a class="code" href="namespaceO__SESSAME.html#aa03fb4f40ef9d7154a59fc366e35c768">MatrixIndexBase</a>+numEqs)) = inputs;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                ++ii;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="keywordflow">if</span>(t.<a class="code" href="classO__SESSAME_1_1ssfTime.html#a2e283e1e7262b7f5e00bd1cef2427829">GetSeconds</a>() + h &gt; timeFinal.<a class="code" href="classO__SESSAME_1_1ssfTime.html#a2e283e1e7262b7f5e00bd1cef2427829">GetSeconds</a>())</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    h = timeFinal - t;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">// Because we used a dynamic vector&lt;Vector&gt;, we need to move this a Matrix    </span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="classCAMdoubleMatrix.html">Matrix</a> outputMatrix(output.size(), numEqs + 1);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">for</span>(ii = 0; ii &lt; output.size(); ++ii)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            outputMatrix(<a class="code" href="namespaceO__SESSAME.html#aa03fb4f40ef9d7154a59fc366e35c768">MatrixIndexBase</a> + ii,<a class="code" href="access_8h.html#a897762bc9d770a93b04900046ac844b6">_</a>) = ~output[ii](<a class="code" href="access_8h.html#a897762bc9d770a93b04900046ac844b6">_</a>); </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">return</span> outputMatrix;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;} <span class="comment">// close namespace O_SESSAME</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">// Do not change the comments below - they will be added automatically by CVS</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">/*****************************************************************************</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">*       $Log: RungeKuttaFehlbergIntegrator.cpp,v $</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">*       Revision 1.5  2003/06/05 20:30:52  nilspace</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">*       Removed testing cout commands.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">*       </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">*       Revision 1.4  2003/06/05 20:09:14  nilspace</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">*       Finished implementation and verified against a short 2 second integration.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">*       </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">*       Revision 1.3  2003/05/22 02:59:15  nilspace</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">*       Updated comments. Changed to pass in pointers to Orbit &amp; Attitude objects.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">*       </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">*       Revision 1.2  2003/04/25 13:45:55  nilspace</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">*       const&#39;d Get() functions.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">*       </span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">*       Revision 1.1  2003/04/23 15:08:28  nilspace</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">*       Initial submission of RKF integrator.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">*       </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">*       </span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">******************************************************************************/</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="ttc" id="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator_html_a9beb30ac980ef4eb16ec750186388dc4"><div class="ttname"><a href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#a9beb30ac980ef4eb16ec750186388dc4">O_SESSAME::RungeKuttaFehlbergIntegrator::m_minStepSize</a></div><div class="ttdeci">double m_minStepSize</div><div class="ttdef"><b>Definition:</b> <a href="RungeKuttaFehlbergIntegrator_8h_source.html#l00053">RungeKuttaFehlbergIntegrator.h:53</a></div></div>
<div class="ttc" id="classO__SESSAME_1_1Attitude_html"><div class="ttname"><a href="classO__SESSAME_1_1Attitude.html">O_SESSAME::Attitude</a></div><div class="ttdef"><b>Definition:</b> <a href="Attitude_8h_source.html#l00051">Attitude.h:51</a></div></div>
<div class="ttc" id="camblas_2f2c_8h_html_a3aa069ac3980707dae1e0530f50d59e4"><div class="ttname"><a href="camblas_2f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a></div><div class="ttdeci">#define abs(x)</div><div class="ttdef"><b>Definition:</b> <a href="camblas_2f2c_8h_source.html#l00151">camblas/f2c.h:151</a></div></div>
<div class="ttc" id="access_8h_html_a897762bc9d770a93b04900046ac844b6"><div class="ttname"><a href="access_8h.html#a897762bc9d770a93b04900046ac844b6">_</a></div><div class="ttdeci">static CAMunderscore _</div><div class="ttdef"><b>Definition:</b> <a href="access_8h_source.html#l00024">access.h:24</a></div></div>
<div class="ttc" id="namespaceO__SESSAME_html_aa03fb4f40ef9d7154a59fc366e35c768"><div class="ttname"><a href="namespaceO__SESSAME.html#aa03fb4f40ef9d7154a59fc366e35c768">O_SESSAME::MatrixIndexBase</a></div><div class="ttdeci">const int MatrixIndexBase</div><div class="ttdef"><b>Definition:</b> <a href="Matrix_8h_source.html#l00022">Matrix.h:22</a></div></div>
<div class="ttc" id="classO__SESSAME_1_1Functor_html"><div class="ttname"><a href="classO__SESSAME_1_1Functor.html">O_SESSAME::Functor</a></div><div class="ttdoc">Abstract class to hold the pointer to an force calculating functor.A Function Object, or Functor (the two terms are synonymous) is simply any object that can be called as if it is a function. It is used to define a call-back function that evaluates any algorithm that takes the defined inputs and returns a vector of values. Examples of usage include evaluating a disturbance force or torque given the current time, orbit state, and attitude state. The returned vector will then be the 3 forces (or torques). </div><div class="ttdef"><b>Definition:</b> <a href="Functor_8h_source.html#l00063">Functor.h:63</a></div></div>
<div class="ttc" id="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator_html_a4f68217899f0d4a046c0d697a4aa9d9f"><div class="ttname"><a href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#a4f68217899f0d4a046c0d697a4aa9d9f">O_SESSAME::RungeKuttaFehlbergIntegrator::Integrate</a></div><div class="ttdeci">Matrix Integrate(const vector&lt; ssfTime &gt; &amp;_propTime, odeFunctor _odeFunctorPtr, const Vector &amp;_initialConditions, Orbit *_pOrbit, Attitude *_pAttitude, const Matrix &amp;_constants, const Functor &amp;_functorPtr)</div><div class="ttdef"><b>Definition:</b> <a href="RungeKuttaFehlbergIntegrator_8cpp_source.html#l00021">RungeKuttaFehlbergIntegrator.cpp:21</a></div></div>
<div class="ttc" id="classO__SESSAME_1_1ssfTime_html_a2e283e1e7262b7f5e00bd1cef2427829"><div class="ttname"><a href="classO__SESSAME_1_1ssfTime.html#a2e283e1e7262b7f5e00bd1cef2427829">O_SESSAME::ssfTime::GetSeconds</a></div><div class="ttdeci">ssfSeconds GetSeconds() const </div><div class="ttdoc">Return the current time in seconds. </div><div class="ttdef"><b>Definition:</b> <a href="Time_8h_source.html#l00202">Time.h:202</a></div></div>
<div class="ttc" id="classO__SESSAME_1_1ssfTime_html"><div class="ttname"><a href="classO__SESSAME_1_1ssfTime.html">O_SESSAME::ssfTime</a></div><div class="ttdoc">Simulation Time objectssfTime is used to encapsulate a representation of time and provide the functio...</div><div class="ttdef"><b>Definition:</b> <a href="Time_8h_source.html#l00075">Time.h:75</a></div></div>
<div class="ttc" id="namespaceO__SESSAME_html_aa5cbaab43220a5b5e4dcfecb6d6644f6"><div class="ttname"><a href="namespaceO__SESSAME.html#aa5cbaab43220a5b5e4dcfecb6d6644f6">O_SESSAME::Vector</a></div><div class="ttdeci">CAMdoubleVector Vector</div><div class="ttdef"><b>Definition:</b> <a href="Matrix_8h_source.html#l00027">Matrix.h:27</a></div></div>
<div class="ttc" id="group__IntegrationLibrary_html_ga1cbb02291f0827a9a385849d7a24fd73"><div class="ttname"><a href="group__IntegrationLibrary.html#ga1cbb02291f0827a9a385849d7a24fd73">O_SESSAME::odeFunctor</a></div><div class="ttdeci">Vector(* odeFunctor)(const ssfTime &amp;_time, const Vector &amp;_integratingState, Orbit *_pOrbit, Attitude *_pAttitude, const Matrix &amp;_parameters, const Functor &amp;_forceFunctorPtr)</div><div class="ttdoc">defines a pointer to an integrator&#39;s right-hand side (RHS) function using a functor for the arbitrary...</div><div class="ttdef"><b>Definition:</b> <a href="Integrator_8h_source.html#l00078">Integrator.h:78</a></div></div>
<div class="ttc" id="classCAMdoubleVector_html"><div class="ttname"><a href="classCAMdoubleVector.html">CAMdoubleVector</a></div><div class="ttdef"><b>Definition:</b> <a href="dvector_8h_source.html#l00033">dvector.h:33</a></div></div>
<div class="ttc" id="classCAMvectorBase_html_a5a3aa53604c8cf36819e1cb38002787f"><div class="ttname"><a href="classCAMvectorBase.html#a5a3aa53604c8cf36819e1cb38002787f">CAMvectorBase::getIndexCount</a></div><div class="ttdeci">long getIndexCount() const </div><div class="ttdef"><b>Definition:</b> <a href="vecbse_8cpp_source.html#l00755">vecbse.cpp:755</a></div></div>
<div class="ttc" id="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator_html_af288d8eab8dce90b3ecbedfab54d26c6"><div class="ttname"><a href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#af288d8eab8dce90b3ecbedfab54d26c6">O_SESSAME::RungeKuttaFehlbergIntegrator::m_maxStepSize</a></div><div class="ttdeci">double m_maxStepSize</div><div class="ttdef"><b>Definition:</b> <a href="RungeKuttaFehlbergIntegrator_8h_source.html#l00054">RungeKuttaFehlbergIntegrator.h:54</a></div></div>
<div class="ttc" id="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator_html_a55ed76bd88bb6c4532438237fc1eba16"><div class="ttname"><a href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#a55ed76bd88bb6c4532438237fc1eba16">O_SESSAME::RungeKuttaFehlbergIntegrator::RungeKuttaFehlbergIntegrator</a></div><div class="ttdeci">RungeKuttaFehlbergIntegrator()</div><div class="ttdef"><b>Definition:</b> <a href="RungeKuttaFehlbergIntegrator_8cpp_source.html#l00017">RungeKuttaFehlbergIntegrator.cpp:17</a></div></div>
<div class="ttc" id="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator_html_aa730511f060f890a529a58922f73e0f2"><div class="ttname"><a href="classO__SESSAME_1_1RungeKuttaFehlbergIntegrator.html#aa730511f060f890a529a58922f73e0f2">O_SESSAME::RungeKuttaFehlbergIntegrator::m_Tolerance</a></div><div class="ttdeci">double m_Tolerance</div><div class="ttdef"><b>Definition:</b> <a href="RungeKuttaFehlbergIntegrator_8h_source.html#l00052">RungeKuttaFehlbergIntegrator.h:52</a></div></div>
<div class="ttc" id="classCAMdoubleMatrix_html"><div class="ttname"><a href="classCAMdoubleMatrix.html">CAMdoubleMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="dmatrix_8h_source.html#l00033">dmatrix.h:33</a></div></div>
<div class="ttc" id="namespaceO__SESSAME_html"><div class="ttname"><a href="namespaceO__SESSAME.html">O_SESSAME</a></div><div class="ttdef"><b>Definition:</b> <a href="Attitude_8cpp_source.html#l00017">Attitude.cpp:17</a></div></div>
<div class="ttc" id="classO__SESSAME_1_1Orbit_html"><div class="ttname"><a href="classO__SESSAME_1_1Orbit.html">O_SESSAME::Orbit</a></div><div class="ttdef"><b>Definition:</b> <a href="Orbit_8h_source.html#l00057">Orbit.h:57</a></div></div>
<div class="ttc" id="RungeKuttaFehlbergIntegrator_8h_html"><div class="ttname"><a href="RungeKuttaFehlbergIntegrator_8h.html">RungeKuttaFehlbergIntegrator.h</a></div><div class="ttdoc">Runge-Kutta-Fehlberg integrator. </div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_313caf1132e152dd9b58bea13a4052ca.html">utils</a></li><li class="navelem"><a class="el" href="RungeKuttaFehlbergIntegrator_8cpp.html">RungeKuttaFehlbergIntegrator.cpp</a></li>
    <li class="footer">Generated on Mon Dec 29 2014 23:02:09 for Open-Sessame Framework by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
